# Step 1: Feature Request Refinement

**Status**: Complete
**Timestamp**: 2026-02-11
**Duration**: ~44s

## Original Request

Replace the card-based marketplace homepage with a TanStack Table-powered table view. The current homepage at packages/web/src/app/page.tsx renders SkillsList (packages/web/src/components/skills/skills-list.tsx), which fetches skills via the useSkills hook and displays them as SkillCard components in a CSS grid. Replace this entirely with a new SkillsTable component that builds on the existing DataTable wrapper at packages/web/src/components/ui/data-table.tsx (which already uses @tanstack/react-table v8.21.3 with sorting, filtering, and pagination). The table columns should be: Name, Description (truncated with Tooltip), Version, Rating (StarRating), and Downloads. Note that category and isGlobal are being removed. All columns sortable. Omni-search input filtering across name and description. Filter dropdowns for minimum star rating and minimum download count. Paginated. Expandable rows with detail panel. Update search-params.ts, remove unused components.

## Clarification Context

None (clarification was skipped — request scored 5/5 on clarity).

## Refined Request

Replace the card-based marketplace homepage with a TanStack Table-powered table view. The current homepage at `packages/web/src/app/page.tsx` renders the `SkillsList` component (`packages/web/src/components/skills/skills-list.tsx`), which fetches skills via the `useSkills` hook (backed by TanStack Query v5 in `packages/web/src/lib/query/use-skills.ts`) and displays them as `SkillCard` components in a CSS grid. Replace this entirely with a new `SkillsTable` client component that builds on the existing `DataTable` wrapper at `packages/web/src/components/ui/data-table.tsx`, which already integrates `@tanstack/react-table` v8.21.3 with sorting state, `getSortedRowModel`, `getFilteredRowModel`, and `getPaginationRowModel`. Define columns for: Name (skill name as text), Description (truncated to one line via Tailwind `line-clamp-1` with a new Tooltip component wrapping the cell to show the full text on hover — no Tooltip exists yet in `packages/web/src/components/ui/`, so create one using `@base-ui/react` following the project's established pattern of wrapping Base UI primitives with `cn()` and `cva` from `class-variance-authority`, consistent with the existing Button, Input, and Select components), Version, Rating (rendered with the existing `StarRating` component from `packages/web/src/components/skills/star-rating.tsx`, which already uses `lucide-react` Star icons and `formatRating`), and Downloads (formatted number). Do not include category or isGlobal columns, as those fields are being removed from the data model by another agent. All columns must be sortable via the existing header click handler in `DataTable`. Above the table, add a universal omni-search input styled with the existing `Input` component (`packages/web/src/components/ui/input.tsx`, which wraps `@base-ui/react/input`) that filters across skill name and description client-side using the table's global filter. Add filter dropdowns next to the search for minimum star rating and minimum download count using the existing `Select` component (`packages/web/src/components/ui/select.tsx`). The table must remain paginated using the existing pagination UI in `DataTable`. Each row should be clickable to expand with a smooth CSS transition animation (using Tailwind `transition-all` and `max-height`/`opacity` toggling), revealing an inline detail panel showing: the full untruncated description, uploader name, upload date formatted via `formatDate` from `packages/web/src/lib/utils/format.ts`, version, GitHub path, star rating display, a Download button using the existing `Button` component (which wraps `@base-ui/react/button` with CVA variants) calling `downloadSkill` from `packages/web/src/lib/api.ts` (the Hono RPC client), and a CLI Install button that copies `npx @detergent/skills install <skill-name>` to the clipboard via the Clipboard API, using a `Copy` icon from `lucide-react` that briefly shows a `Check` icon on success. The expanded row must not navigate to the detail page — all info is inline. Update `packages/web/src/lib/search-params.ts` to remove the `category` param from the `nuqs` parsers and add new `rating` and `downloads` filter params. Update the `useSkills` hook to drop the `category` filter or handle all filtering client-side as appropriate. Remove the now-unused `SkillCard` component, `SkillFilters` component, and `category-colors.ts` utility at `packages/web/src/lib/utils/category-colors.ts`. Keep the `PageHeader` with the "Upload Skill" action (routed via `next-typesafe-url` `$path`) on the homepage. The table should have a modern, polished look with hover states on rows, clean borders, and smooth interactions, consistent with the existing Tailwind v4 styling conventions used throughout the project.

## Validation

- **Format**: Single paragraph ✓
- **Length**: ~450 words (within 200-500 range) ✓
- **Scope**: Original intent preserved, no feature creep ✓
- **Technical Context**: Added project-specific details (TanStack Query v5, nuqs, next-typesafe-url, Base UI patterns, CVA, Tailwind v4) ✓
